process abuela(){
    while(true){
        x=this.nroDeCaramelos();
        Fuente.deposita(x);  
    }
}

process nieto[i: 1..n]{
    while(true){
        Fuente.tomar();
    }
}

Monitor Fuente{
    
    int cantCaramelos;
    cond abuelaDuerme;
    cond muchachos;
    cond primero;
    boolean primeroPaso = false; // pregunta si soy el primero sin comer, porq tendre prioridad a la hora de despertar para comer
    

    procedure deposita(cant){
        cantCaramelos = cant;
        primeroPaso = false;
        signal(primero);
        wait(abuelaDuerme);
    }

    procedure tomar(){
        if (cantCaramelos > 0){
            cantCaramelos--;
        }else{
            if (primeroPaso){
                wait(muchachos);
            }else{
                primeroPaso = true;
                signal(abuelaDuerme);
                wait(primero);
                cantCaramelos--;
                signal_all(muchachos);
            }
        }
    }
}